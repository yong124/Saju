<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Saju | ê·€ì—½ê³  ê¹”ë”í•œ ìš´ì„¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ì¿ í‚¤ëŸ° ìŠ¤íƒ€ì¼ì˜ ìƒë™ê° ìˆëŠ” ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
            --primary-red: #FF5E5E;
            --primary-yellow: #FFD950;
            --text-brown: #5D4037;
            --bg-cream: #FFF9F0;
            --card-white: #FFFFFF;
            --border-beige: #E8DCC0;
        }

        body { 
            font-family: 'Nanum Gothic', sans-serif; 
            background-color: var(--bg-cream); 
            color: var(--text-brown);
            /* ë•¡ë•¡ì´ ì œê±°í•˜ê³  ë¯¸ì„¸í•œ ì¢…ì´ ì§ˆê° ì¶”ê°€ (ì„ íƒì‚¬í•­) */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        }

        .font-title { font-family: 'Jua', sans-serif; }

        /* 3D í„°ì¹˜ê° ë²„íŠ¼ */
        .btn-action {
            background-color: var(--primary-red);
            color: white;
            border-radius: 20px;
            border-bottom: 6px solid #D64545;
            transition: all 0.1s;
            font-family: 'Jua', sans-serif;
        }
        .btn-action:active {
            transform: translateY(4px);
            border-bottom-width: 2px;
            margin-top: 4px;
        }
        
        /* ì¹´í…Œê³ ë¦¬ ì¹© ë²„íŠ¼ */
        .chip {
            background-color: white;
            border: 2px solid var(--border-beige);
            color: #A1887F;
            border-radius: 12px;
            font-family: 'Jua', sans-serif;
            transition: all 0.2s;
            box-shadow: 0 2px 0 var(--border-beige);
        }
        .chip.active {
            border-color: var(--primary-red);
            color: var(--primary-red);
            background-color: #FFF0F0;
            box-shadow: 0 2px 0 var(--primary-red);
            transform: translateY(-1px);
        }

        /* ë©”ì¸ íƒ­ */
        .main-tab {
            display: flex;
            background: #EFE6D5;
            padding: 6px;
            border-radius: 20px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        .tab-btn {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            border-radius: 16px;
            cursor: pointer;
            font-family: 'Jua', sans-serif;
            color: #A1887F;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .tab-btn.active {
            background: white;
            color: var(--text-brown);
            box-shadow: 0 4px 10px rgba(93, 64, 55, 0.1);
            transform: scale(1.02);
        }

        /* ì¹´ë“œ ì»¨í…Œì´ë„ˆ */
        .content-card {
            background-color: var(--card-white);
            border-radius: 24px;
            box-shadow: 0 8px 24px rgba(93, 64, 55, 0.08);
            border: 1px solid white;
        }

        /* ì…ë ¥ í¼ */
        .input-field {
            background-color: #FFFCF5;
            border: 2px solid var(--border-beige);
            border-radius: 14px;
            color: var(--text-brown);
            transition: all 0.3s;
        }
        .input-field:focus {
            outline: none;
            border-color: var(--primary-yellow);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(255, 217, 80, 0.2);
        }

        /* íƒ€ë¡œ ì¹´ë“œ ì• ë‹ˆë©”ì´ì…˜ */
        .tarot-scene {
            perspective: 1000px;
            width: 100%;
            aspect-ratio: 2/3.2;
            cursor: pointer;
        }
        .tarot-obj {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-style: preserve-3d;
        }
        .tarot-scene.flipped .tarot-obj { transform: rotateY(180deg); }
        .face {
            position: absolute;
            inset: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .face-back {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid white;
        }
        .face-back::after { content: 'â˜…'; color: white; font-size: 2rem; opacity: 0.8; }
        .face-front {
            transform: rotateY(180deg);
            background-color: white;
            border: 3px solid var(--primary-yellow);
            overflow: hidden;
        }
        .face-front img { width: 100%; height: 100%; object-fit: cover; }

        /* ì• ë‹ˆë©”ì´ì…˜ ìœ í‹¸ */
        .fade-in { animation: fadeIn 0.6s ease-out forwards; opacity: 0; transform: translateY(15px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        .spin { animation: spin 1.5s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="w-full py-4 px-6 flex justify-between items-center bg-white/80 backdrop-blur sticky top-0 z-50 border-b border-[#F0E6D2]">
        <div class="font-title text-2xl text-[#FF5E5E] tracking-wide cursor-pointer flex items-center" onclick="location.reload()">
            <i class="fa-solid fa-cookie-bite mr-2 text-[#FFD950]"></i>Vibe Saju
        </div>
        <div class="text-xs font-bold text-[#A1887F] bg-[#EFE6D5] px-3 py-1 rounded-full">
            BETA
        </div>
    </nav>

    <main class="w-full max-w-md px-5 pt-8 pb-32">
        
        <!-- íˆì–´ë¡œ íƒ€ì´í‹€ -->
        <header class="text-center mb-10 fade-in">
            <p class="text-xs text-[#A1887F] font-bold mb-2 tracking-widest bg-white inline-block px-3 py-1 rounded-full shadow-sm">AI ìš´ì„¸ & íƒ€ë¡œ ë¶„ì„</p>
            <h2 class="font-title text-3xl text-[#4A321F] leading-tight">
                ë‹¹ì‹ ì˜ ì˜¤ëŠ˜ì„<br><span class="text-[#FF5E5E]">ë‹¬ì½¤í•˜ê²Œ</span> êµ¬ì›Œë“œë¦´ê²Œìš”!
            </h2>
        </header>

        <!-- ë©”ì¸ ëª¨ë“œ íƒ­ -->
        <div class="main-tab mb-8 fade-in" style="animation-delay: 0.1s;">
            <div onclick="setMode('saju')" id="tab-saju" class="tab-btn active text-lg">ğŸ“œ ì •í†µ ì‚¬ì£¼</div>
            <div onclick="setMode('tarot')" id="tab-tarot" class="tab-btn text-lg">ğŸ”® ì‹¬ì¸µ íƒ€ë¡œ</div>
        </div>

        <!-- ================= SAJU SECTION ================= -->
        <section id="section-saju" class="space-y-6 fade-in" style="animation-delay: 0.2s;">
            <!-- ì‚¬ì£¼ ì£¼ì œ ì„ íƒ -->
            <div class="grid grid-cols-3 gap-2">
                <button onclick="setSajuType('total')" id="st-total" class="chip active py-3 text-sm">ğŸ€ ì¢…í•© ìš´ì„¸</button>
                <button onclick="setSajuType('love')" id="st-love" class="chip py-3 text-sm">ğŸ’• ì—°ì• /ì• ì •</button>
                <button onclick="setSajuType('wealth')" id="st-wealth" class="chip py-3 text-sm">ğŸ’° ì¬ë¬¼/ì„±ê³µ</button>
            </div>

            <div class="content-card p-6 space-y-5">
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-[#8D6E63] mb-1.5 pl-1">ì´ë¦„ (Name)</label>
                        <input type="text" id="userName" class="w-full input-field p-3 text-base" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-xs font-bold text-[#8D6E63] mb-1.5 pl-1">ìƒë…„ì›”ì¼</label>
                            <input type="date" id="userBirth" class="w-full input-field p-3 text-sm">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-[#8D6E63] mb-1.5 pl-1">íƒœì–´ë‚œ ì‹œê°„</label>
                            <select id="userTime" class="w-full input-field p-3 text-sm cursor-pointer">
                                <option value="unknown">ëª¨ë¦„</option>
                                <option value="ja">ìì‹œ (23:30~)</option>
                                <option value="chuk">ì¶•ì‹œ (01:30~)</option>
                                <option value="in">ì¸ì‹œ (03:30~)</option>
                                <option value="myo">ë¬˜ì‹œ (05:30~)</option>
                                <option value="jin">ì§„ì‹œ (07:30~)</option>
                                <option value="sa">ì‚¬ì‹œ (09:30~)</option>
                                <option value="o">ì˜¤ì‹œ (11:30~)</option>
                                <option value="mi">ë¯¸ì‹œ (13:30~)</option>
                                <option value="shin">ì‹ ì‹œ (15:30~)</option>
                                <option value="yu">ìœ ì‹œ (17:30~)</option>
                                <option value="sul">ìˆ ì‹œ (19:30~)</option>
                                <option value="hae">í•´ì‹œ (21:30~)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="pt-2">
                    <button onclick="calculateSaju()" class="w-full btn-action py-4 text-xl shadow-lg">
                        ì‚¬ì£¼ ë¶„ì„ ì‹œì‘í•˜ê¸° âœ¨
                    </button>
                </div>
            </div>
        </section>

        <!-- ================= TAROT SECTION ================= -->
        <section id="section-tarot" class="hidden space-y-6 fade-in" style="animation-delay: 0.2s;">
            <!-- íƒ€ë¡œ ì£¼ì œ ì„ íƒ (ë¦¬íŒ©í† ë§ë¨) -->
            <div class="grid grid-cols-3 gap-2">
                <button onclick="setTarotType('situation')" id="tt-situation" class="chip active py-3 text-sm">ğŸ¤” í˜„ì¬ ê³ ë¯¼</button>
                <button onclick="setTarotType('choice')" id="tt-choice" class="chip py-3 text-sm">âš–ï¸ ì–‘ì íƒì¼</button>
                <button onclick="setTarotType('future')" id="tt-future" class="chip py-3 text-sm">ğŸš€ ë¯¸ë˜ íë¦„</button>
            </div>

            <!-- ì¸íŠ¸ë¡œ í™”ë©´ -->
            <div id="tarot-intro" class="content-card p-8 text-center space-y-6">
                <div class="w-24 h-24 bg-[#FFF0F0] rounded-full flex items-center justify-center mx-auto text-5xl shadow-inner">
                    ğŸ”®
                </div>
                <div>
                    <h3 class="font-title text-2xl text-[#4A321F] mb-3">ì¹´ë“œê°€ ë‹µì„ ì¤„ ê±°ì˜ˆìš”</h3>
                    <p class="text-sm text-[#8D6E63] leading-relaxed">
                        ë§ˆìŒì†ìœ¼ë¡œ ê³ ë¯¼ì„ ê¹Šê²Œ ìƒê°í•œ ë’¤,<br>
                        ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¹´ë“œë¥¼ ì„ì–´ì£¼ì„¸ìš”.
                    </p>
                </div>
                <button onclick="startShuffle()" class="w-full btn-action py-4 text-xl">
                    ì¹´ë“œ ì„ê¸° ì‹œì‘!
                </button>
            </div>

            <!-- ì…”í”Œ í™”ë©´ -->
            <div id="tarot-shuffle" class="hidden text-center py-12 space-y-10">
                <div class="text-7xl animate-bounce">ğŸ”€</div>
                <h3 class="font-title text-2xl text-[#FF5E5E]">ì¹´ë“œë¥¼ ì„ëŠ” ì¤‘...</h3>
                <p class="text-sm text-[#8D6E63]">ì¶©ë¶„íˆ ì„ì˜€ë‹¤ê³  ìƒê°ë˜ë©´ ë©ˆì¶°ì£¼ì„¸ìš”!</p>
                <button onclick="stopShuffle()" class="w-full btn-action py-4 text-xl">STOP!</button>
            </div>

            <!-- ì„ íƒ í™”ë©´ -->
            <div id="tarot-select" class="hidden space-y-4">
                <div class="text-center p-3 bg-white rounded-xl border border-[#F0E6D2] shadow-sm">
                    <p class="text-xs font-bold text-[#FF5E5E]" id="pick-instruction">ğŸ‘‡ ìˆœì„œëŒ€ë¡œ 3ì¥ì„ ë½‘ì•„ì£¼ì„¸ìš”</p>
                </div>
                <div class="grid grid-cols-3 gap-3" id="card-grid"></div>
            </div>
        </section>

        <!-- ================= RESULT SECTION ================= -->
        <div id="result-area" class="hidden mt-6 fade-in w-full">
            <!-- ë¡œë”© í™”ë©´ -->
            <div id="loading" class="py-20 flex flex-col items-center">
                <div class="w-12 h-12 border-4 border-[#F0E6D2] border-t-[#FF5E5E] rounded-full spin mb-6"></div>
                <p class="font-title text-xl text-[#8D6E63]">AIê°€ ìš´ëª…ì„ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</p>
                <p class="text-xs text-[#A1887F] mt-2">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸª</p>
            </div>

            <!-- ê²°ê³¼ ì¹´ë“œ -->
            <div id="result-content" class="hidden content-card p-0 relative overflow-hidden">
                <div class="bg-[#FF5E5E] p-4 text-center">
                    <span class="bg-white/20 text-white px-3 py-1 rounded-full text-[10px] font-bold tracking-wider uppercase">Analysis Complete</span>
                    <h2 id="result-title" class="font-title text-2xl mt-2 text-white leading-snug"></h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- ê²°ê³¼ ë³¸ë¬¸ -->
                    <div id="result-body" class="bg-[#FFFCF5] p-5 rounded-xl border border-[#F0E6D2] text-sm leading-relaxed text-justify text-[#5D4037]"></div>

                    <!-- íƒ€ë¡œ ê²°ê³¼ ì´ë¯¸ì§€ (íƒ€ë¡œ ëª¨ë“œì¼ ë•Œë§Œ í‘œì‹œ) -->
                    <div id="tarot-result-images" class="hidden grid grid-cols-3 gap-2">
                        <!-- JSë¡œ ì´ë¯¸ì§€ ì£¼ì… -->
                    </div>

                    <!-- í”„ë¦¬ë¯¸ì—„ ë°°ë„ˆ (ìˆ˜ìµí™”) -->
                    <div class="bg-gradient-to-r from-[#FFFDE7] to-[#FFF59D] p-5 rounded-2xl text-center shadow-sm cursor-pointer hover:shadow-md transition border border-[#FFF176] group">
                        <div class="flex items-center justify-center space-x-2 mb-1">
                            <span class="text-lg">ğŸ</span>
                            <p class="font-title text-[#FBC02D] text-lg group-hover:scale-105 transition-transform">2025 ëŒ€ìš´ ë¦¬í¬íŠ¸</p>
                        </div>
                        <p class="text-xs text-[#F9A825] mb-4">ë†“ì¹˜ë©´ í›„íšŒí•  ë‹¹ì‹ ì˜ í–‰ìš´ ì‹œê¸°ë¥¼ ì•Œë ¤ë“œë ¤ìš”.</p>
                        <button class="bg-white text-[#F9A825] px-8 py-2.5 rounded-full text-xs font-bold shadow-sm group-hover:bg-[#F9A825] group-hover:text-white transition-colors">
                            ì‹œí¬ë¦¿ ë¦¬í¬íŠ¸ ì—´ê¸° (3,000ì›)
                        </button>
                    </div>

                    <div class="flex gap-3 pt-2">
                        <button onclick="shareResult()" class="flex-1 bg-[#3E2723] text-white py-3.5 rounded-xl text-sm font-bold shadow-md hover:bg-[#5D4037] transition">
                            <i class="fa-solid fa-share-nodes mr-2"></i>ê³µìœ í•˜ê¸°
                        </button>
                        <button onclick="location.reload()" class="flex-1 bg-white border border-[#D7CCC8] text-[#5D4037] py-3.5 rounded-xl text-sm font-bold hover:bg-[#EFEBE9] transition">
                            ì²˜ìŒìœ¼ë¡œ
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="w-full py-8 text-center text-[#BCAAA4] text-[10px] bg-white border-t border-[#F0E6D2]">
        <p class="mb-1 font-bold">Vibe Saju Team</p>
        <p>&copy; 2025 Vibe Saju. All rights reserved.</p>
    </footer>

    <script>
        // ================= ë°ì´í„°ë² ì´ìŠ¤ =================
        const STEMS = {
            0: { name: "ê²½ê¸ˆ(åºšé‡‘)", nature: "ë‹¨ë‹¨í•œ ë°”ìœ„", desc: "êµ³ì€ ì˜ì§€ì™€ ê²°ë‹¨ë ¥ì˜ ì†Œìœ ì! ë§ºê³  ëŠìŒì´ í™•ì‹¤í•´ìš”." },
            1: { name: "ì‹ ê¸ˆ(è¾›é‡‘)", nature: "ë°˜ì§ì´ëŠ” ë³´ì„", desc: "ì„¬ì„¸í•˜ê³  ì˜ˆë¦¬í•˜ë©°, ìì‹ ì„ ë¹›ë‚´ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•´ìš”." },
            2: { name: "ì„ìˆ˜(å£¬æ°´)", nature: "ë„“ì€ ë°”ë‹¤", desc: "ê¹Šì€ ì§€í˜œì™€ í¬ìš©ë ¥ì„ ê°€ì¡Œì–´ìš”. ìœ ì—°í•¨ì´ ê°•ì ì´ì—ìš”." },
            3: { name: "ê³„ìˆ˜(ç™¸æ°´)", nature: "ì´‰ì´‰í•œ ë´„ë¹„", desc: "ë‹¤ì •ë‹¤ê°í•˜ê³  ì•„ì´ë””ì–´ê°€ ë„˜ì³ìš”. ì„¬ì„¸í•œ ê°ì„±ì˜ ì†Œìœ ì!" },
            4: { name: "ê°‘ëª©(ç”²æœ¨)", nature: "ìš°ì§í•œ ì†Œë‚˜ë¬´", desc: "ë¦¬ë”ì‹­ì´ ê°•í•˜ê³  êµ½íˆê¸° ì‹«ì–´í•˜ëŠ” ê°•ì§í•¨ì´ ìˆì–´ìš”." },
            5: { name: "ì„ëª©(ä¹™æœ¨)", nature: "ê°•ì¸í•œ ë©êµ´", desc: "ìƒí™œë ¥ì´ ê°•í•˜ê³  ëˆê¸°ê°€ ëŒ€ë‹¨í•´ìš”. ì™¸ìœ ë‚´ê°•í˜•!" },
            6: { name: "ë³‘í™”(ä¸™ç«)", nature: "íƒ€ì˜¤ë¥´ëŠ” íƒœì–‘", desc: "ì—´ì •ì ì´ê³  ì†”ì§í•´ìš”. ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ì—ë„ˆì§€ë¥¼ ì¤˜ìš”." },
            7: { name: "ì •í™”(ä¸ç«)", nature: "ë”°ìŠ¤í•œ ì´›ë¶ˆ", desc: "í—Œì‹ ì ì´ê³  ë”°ëœ»í•´ìš”. ë‚´ë©´ì— ëœ¨ê±°ìš´ ì—´ì •ì„ í’ˆê³  ìˆì£ ." },
            8: { name: "ë¬´í† (æˆŠåœŸ)", nature: "ë¯¿ìŒì§í•œ ì‚°", desc: "ë¬µì§í•˜ê³  ì‹ ìš©ì„ ì¤‘ì‹œí•´ìš”. ì‚¬ëŒë“¤ì´ ë§ì´ ì˜ì§€í•˜ëŠ” í¸ì´ì—ìš”." },
            9: { name: "ê¸°í† (å·±åœŸ)", nature: "ë¹„ì˜¥í•œ í…ƒë°­", desc: "ì‹¤ì† ìˆê³  ë‹¤ì¬ë‹¤ëŠ¥í•´ìš”. ëˆ„êµ¬ì™€ë„ ì˜ ì–´ìš¸ë¦¬ëŠ” ì„±ê²©!" }
        };

        const TAROT_DECK = [
            { name: "The Fool", img: "https://images.unsplash.com/photo-1614726365618-2c2621746200?w=300&q=80", key: "ìƒˆë¡œìš´ ì‹œì‘" },
            { name: "The Magician", img: "https://images.unsplash.com/photo-1596727147705-54a9d0822607?w=300&q=80", key: "ëŠ¥ë ¥ ë°œíœ˜" },
            { name: "The Lovers", img: "https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=300&q=80", key: "ì‚¬ë‘ê³¼ ì„ íƒ" },
            { name: "The Wheel", img: "https://images.unsplash.com/photo-1538370965046-79c0d6907d47?w=300&q=80", key: "ìš´ëª…ì˜ ë³€í™”" },
            { name: "The Sun", img: "https://images.unsplash.com/photo-1532693322450-2cb5c511067d?w=300&q=80", key: "ê¸ì •ì  ì—ë„ˆì§€" },
            { name: "Death", img: "https://images.unsplash.com/photo-1509024644558-2f56ce76c490?w=300&q=80", key: "ëê³¼ ì‹œì‘" }
        ];

        // ìƒíƒœ ë³€ìˆ˜
        let currentMode = 'saju';
        let sajuType = 'total';
        let tarotType = 'situation';
        let selectedCards = [];

        // ================= UI ë¡œì§ =================
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(`tab-${mode}`).classList.add('active');

            document.getElementById('section-saju').classList.add('hidden');
            document.getElementById('section-tarot').classList.add('hidden');
            document.getElementById('result-area').classList.add('hidden');
            document.getElementById(`section-${mode}`).classList.remove('hidden');
        }

        function setSajuType(type) {
            sajuType = type;
            document.querySelectorAll('#section-saju .chip').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`st-${type}`).classList.add('active');
        }

        function setTarotType(type) {
            tarotType = type;
            document.querySelectorAll('#section-tarot .chip').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tt-${type}`).classList.add('active');
        }

        // ================= ì‚¬ì£¼ ë¶„ì„ ë¡œì§ =================
        function calculateSaju() {
            const name = document.getElementById('userName').value;
            const birth = document.getElementById('userBirth').value;
            
            if(!name || !birth) { alert("ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ ì´ë¦„ê³¼ ìƒë…„ì›”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }

            showLoading();

            const year = parseInt(birth.split('-')[0]);
            const stemIndex = (year - 4) % 10; 
            const myStem = STEMS[stemIndex < 0 ? stemIndex + 10 : stemIndex];

            setTimeout(() => {
                let title = `"${myStem.name}"ì˜ ê¸°ìš´ì„ ê°€ì§„ ${name}ë‹˜!`;
                let content = `<p class="mb-4 text-[#8D6E63]"><strong>ğŸŒ± ë³¸ì§ˆ ë¶„ì„:</strong><br>${myStem.desc}</p>`;

                // ì£¼ì œë³„ ë©˜íŠ¸ ë¶„ê¸°
                if(sajuType === 'love') {
                    content += `<p class="text-[#FF5E5E]"><strong>ğŸ’– ì• ì •ìš´ íë¦„:</strong><br>ì˜¬í•´ëŠ” ë‹¹ì‹ ì˜ ë§¤ë ¥ì´ ìì—°ìŠ¤ëŸ½ê²Œ ë°œì‚°ë˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì–µì§€ë¡œ ì¸ì—°ì„ ì°¾ìœ¼ë ¤ í•˜ê¸°ë³´ë‹¤, ë‹¹ì‹ ì´ ì¢‹ì•„í•˜ëŠ” ì¼ì— ëª°ë‘í•  ë•Œ ë¹›ë‚˜ëŠ” ëª¨ìŠµì„ ë³´ê³  ëˆ„êµ°ê°€ ë‹¤ê°€ì˜¬ í™•ë¥ ì´ ë†’ì•„ìš”. íŠ¹íˆ ${year % 2 === 0 ? 'ì—¬ë¦„' : 'ê²¨ìš¸'}ì— ë§Œë‚˜ëŠ” ì¸ì—°ì„ ì£¼ëª©í•˜ì„¸ìš”.</p>`;
                } else if(sajuType === 'wealth') {
                    content += `<p class="text-[#FBC02D]"><strong>ğŸ’° ì¬ë¬¼ìš´ íë¦„:</strong><br>ê¾¸ì¤€í•¨ì´ ë‹µì…ë‹ˆë‹¤. ${myStem.nature}ì˜ ê¸°ìš´ì„ ê°€ì§„ ë‹¹ì‹ ì€ ì¼í™•ì²œê¸ˆë³´ë‹¤ ìŒ“ì•„ê°€ëŠ” ì¬ë¬¼ìš´ì´ ê°•í•´ìš”. ì˜¬í•´ëŠ” ìƒˆë¡œìš´ íˆ¬ìë³´ë‹¤ëŠ” ê¸°ì¡´ì˜ ê²ƒì„ ì§€í‚¤ê³  ë¶ˆë ¤ë‚˜ê°€ëŠ” ì „ëµì´ ìœ íš¨í•©ë‹ˆë‹¤.</p>`;
                } else {
                    content += `<p class="text-[#5D4037]"><strong>ğŸ€ ì¢…í•© ì¡°ì–¸:</strong><br>ì£¼ë³€ í™˜ê²½ì´ ë³€í™”í•  ìˆ˜ ìˆì§€ë§Œ, ë‹¹ì‹ ì˜ íƒ€ê³ ë‚œ ëšì‹¬ìœ¼ë¡œ ë°€ê³  ë‚˜ê°€ì„¸ìš”. ê²‰ìœ¼ë¡œëŠ” í”ë“¤ë ¤ ë³´ì—¬ë„ ë¿Œë¦¬ëŠ” ê¹Šê²Œ ë°•í˜€ ìˆìŠµë‹ˆë‹¤.</p>`;
                }

                showResult(title, content, false);
            }, 2000);
        }

        // ================= íƒ€ë¡œ ë¶„ì„ ë¡œì§ =================
        function startShuffle() {
            document.getElementById('tarot-intro').classList.add('hidden');
            document.getElementById('tarot-shuffle').classList.remove('hidden');
        }

        function stopShuffle() {
            document.getElementById('tarot-shuffle').classList.add('hidden');
            const grid = document.getElementById('card-grid');
            document.getElementById('tarot-select').classList.remove('hidden');
            grid.innerHTML = '';
            selectedCards = [];

            // ì¹´ë“œ ë ˆì´ë¸” ì„¤ì • (ì£¼ì œë³„)
            let labels = ["ê³¼ê±°", "í˜„ì¬", "ë¯¸ë˜"];
            if (tarotType === 'choice') labels = ["ì„ íƒ A", "ì„ íƒ B", "ì¡°ì–¸"];
            if (tarotType === 'future') labels = ["ê°€ê¹Œìš´ ë¯¸ë˜", "ì¥ì• ë¬¼", "ìµœì¢… ê²°ê³¼"];
            
            document.getElementById('pick-instruction').innerText = `ğŸ‘‡ ìˆœì„œëŒ€ë¡œ ë½‘ì•„ì£¼ì„¸ìš” (${labels.join(' â” ')})`;

            for(let i=0; i<9; i++) {
                const card = document.createElement('div');
                card.className = 'tarot-scene';
                card.innerHTML = `
                    <div class="tarot-obj">
                        <div class="face face-back"></div>
                        <div class="face face-front"></div>
                    </div>
                `;
                card.onclick = () => selectCard(card, i);
                grid.appendChild(card);
            }
        }

        function selectCard(el, idx) {
            if(selectedCards.length >= 3 || el.classList.contains('flipped')) return;
            el.classList.add('flipped');
            selectedCards.push(idx);

            if(selectedCards.length === 3) {
                setTimeout(analyzeTarot, 1000);
            }
        }

        function analyzeTarot() {
            showLoading();
            
            // ì¹´ë“œ 3ì¥ ëœë¤ ì„ íƒ
            const picks = [];
            for(let i=0; i<3; i++) picks.push(TAROT_DECK[Math.floor(Math.random() * TAROT_DECK.length)]);

            setTimeout(() => {
                const title = tarotType === 'choice' ? "ì–´ë–¤ ì„ íƒì´ ì¢‹ì„ê¹Œìš”?" : "ë‹¹ì‹ ì˜ íë¦„ì„ ì½ì–´ë³´ì•˜ìŠµë‹ˆë‹¤";
                let labels = ["PAST (ê³¼ê±°)", "PRESENT (í˜„ì¬)", "FUTURE (ë¯¸ë˜)"];
                if (tarotType === 'choice') labels = ["OPTION A", "OPTION B", "ADVICE"];
                if (tarotType === 'future') labels = ["NEAR FUTURE", "OBSTACLE", "OUTCOME"];

                // ì´ë¯¸ì§€ í‘œì‹œìš© HTML ìƒì„±
                const imagesHTML = picks.map(card => 
                    `<div class="rounded-lg overflow-hidden border border-[#E0E0E0]"><img src="${card.img}" class="w-full h-24 object-cover"></div>`
                ).join('');
                document.getElementById('tarot-result-images').innerHTML = imagesHTML;
                document.getElementById('tarot-result-images').classList.remove('hidden');

                let content = `<div class="space-y-4">`;
                picks.forEach((card, i) => {
                    content += `
                        <div class="border-l-4 ${i===0 ? 'border-[#FF6B6B]' : i===1 ? 'border-[#FFD93D]' : 'border-[#8B5A2B]'} pl-3">
                            <span class="text-xs text-gray-400 font-bold block mb-1">${labels[i]}</span>
                            <h4 class="font-bold text-[#333]">${card.name} - ${card.key}</h4>
                            <p class="text-sm text-[#666] mt-1">ì´ ì¹´ë“œëŠ” ë‹¹ì‹ ì—ê²Œ ì¤‘ìš”í•œ ë©”ì‹œì§€ë¥¼ ë˜ì§€ê³  ìˆì–´ìš”.</p>
                        </div>
                    `;
                });
                content += `</div>`;
                
                showResult(title, content, true);
            }, 2500);
        }

        // ================= ê³µí†µ í•¨ìˆ˜ =================
        function showLoading() {
            document.getElementById('section-saju').classList.add('hidden');
            document.getElementById('section-tarot').classList.add('hidden');
            document.getElementById('result-area').classList.remove('hidden');
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('result-content').classList.add('hidden');
        }

        function showResult(title, content, isTarot) {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('result-content').classList.remove('hidden');
            document.getElementById('result-title').innerText = title;
            document.getElementById('result-body').innerHTML = content;
            
            if(!isTarot) {
                document.getElementById('tarot-result-images').classList.add('hidden');
            }
        }

        function shareResult() {
            if (navigator.share) {
                navigator.share({ title: 'Vibe Saju', text: 'ë‚´ ìš´ì„¸ í™•ì¸í•´ë³¼ë˜?', url: window.location.href });
            } else {
                alert("ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆì–´ìš”! ì¹œêµ¬ì—ê²Œ ê³µìœ í•´ë³´ì„¸ìš” ğŸ’Œ");
            }
        }
    </script>
</body>
</html>